PROGRAM INIT_WRAPPER_GPU
IMPLICIT NONE
INTEGER, PARAMETER :: N = 2
REAL(KIND=8), POINTER :: D_GPU(:,:)
LOGICAL :: RES
INTEGER :: I,J

RES = .FALSE.

ALLOCATE (D_GPU (N, N))
D_GPU = 7

!$omp target enter data map(alloc: D_GPU)
!$omp target update to(D_GPU)
      

CALL KERNEL()

IF (.NOT. RES) THEN
    ERROR STOP
END IF

CONTAINS

SUBROUTINE KERNEL()

!$OMP TARGET MAP(PRESENT: D_GPU) MAP(TOFROM:RES)

RES=.TRUE.
DO I=1,N
DO J=1,N
print *, D_GPU (I, J)
IF(D_GPU(I,J) /= 7) THEN
        RES = .FALSE.
END IF
END DO
END DO

PRINT *, "RES = ", RES

!$OMP END TARGET

PRINT *, "RES = ", RES

END SUBROUTINE KERNEL

END PROGRAM INIT_WRAPPER_GPU
